# üéØ –ü–û–õ–ù–û–ï –†–ï–®–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ú–ê–†–ö–ï–†–û–í BLUEMAP

## üìã –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´

### –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ:
- ‚ùå **–ö–æ–º–∞–Ω–¥—ã –¥–æ–±–∞–≤–ª—è–ª–∏ –º–∞—Ä–∫–µ—Ä—ã**, –Ω–æ –æ–Ω–∏ **–Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**
- ‚ùå **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—è–≤–ª—è–ª–∏—Å—å –ø—É—Å—Ç—ã–º–∏** –≤ –º–µ–Ω—é
- ‚ùå **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —á–∏—Å–ª–æ–≤—ã–µ ID** —É –º–∞—Ä–∫–µ—Ä–æ–≤
- ‚ùå **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã
- ‚ùå **–ü–æ–∏—Å–∫ –ø–æ —Ä—É—Å—Å–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è–º –Ω–µ —Ä–∞–±–æ—Ç–∞–ª**

### –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã:
1. **–ú–µ—Ç–æ–¥ `saveMarkers()`** –≤ `MarkerAPIImpl` **–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª –¥–∞–Ω–Ω—ã–µ**
2. **–ö–æ–º–∞–Ω–¥—ã –Ω–µ –≤—ã–∑—ã–≤–∞–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –∫–æ–º–∞–Ω–¥–∞ `addset`** —Å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π ID
4. **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö** –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º

## üîß –í–ù–ï–°–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω MarkerAPIImpl.java**
```java
// –§–∞–π–ª: BlueMapNEW/commonNEW/src/main/java/de/bluecolored/bluemap/common/api/marker/MarkerAPIImpl.java

@Override
public void saveMarkers() throws IOException {
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ä–∫–µ—Ä—ã –≤ live/markers.json —á–µ—Ä–µ–∑ storage —Å–∏—Å—Ç–µ–º—ã BlueMap
    try {
        map.saveMarkerState();
        Logger.global.logInfo("Markers saved to live/markers.json for map: " + map.getId());
    } catch (Exception e) {
        Logger.global.logError("Failed to save markers for map: " + map.getId(), e);
        throw new IOException("Failed to save markers", e);
    }
}
```

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –º–∞—Ä–∫–µ—Ä–æ–≤**
```java
// –§–∞–π–ª: BlueMapNEW/commonNEW/src/main/java/de/bluecolored/bluemap/common/commands/commands/MarkerCommand.java

// –î–æ–±–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤:
try {
    markerAPI.saveMarkers();
} catch (Exception e) {
    Logger.global.logError("Failed to save markers after adding marker " + id, e);
}
```

### 3. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `addset` —Å –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π ID**
```java
@Command("markers addset <category> <x> <y> <z> <label>")
@Permission("bluemap.markers.add")
public Component addMarkerSet(CommandContext context) {
    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —á–∏—Å–ª–æ–≤–æ–π ID
    String markerId = generateUniqueMarkerId();
    // ... —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞
}

private String generateUniqueMarkerId() {
    long timestamp = System.currentTimeMillis();
    return "marker_" + (timestamp % 1000000);
}
```

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥**
```java
@Command("markers")
@Permission("bluemap.markers")
public Component markersHelp() {
    return paragraph("–ö–æ–º–∞–Ω–¥—ã –º–∞—Ä–∫–µ—Ä–æ–≤ BlueMap:",
        format("% - —Å–ø–∏—Å–æ–∫ –º–∞—Ä–∫–µ—Ä–æ–≤", text("/bluemap markers list").color(HIGHLIGHT_COLOR)),
        format("% - —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", text("/bluemap markers create <category> <label>").color(HIGHLIGHT_COLOR)),
        format("% - —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é", text("/bluemap markers remove <category>").color(HIGHLIGHT_COLOR)),
        format("% - –¥–æ–±–∞–≤–∏—Ç—å POI –º–∞—Ä–∫–µ—Ä —Å ID", text("/bluemap markers add <category> <id> <x> <y> <z> <label>").color(HIGHLIGHT_COLOR)),
        format("% - –¥–æ–±–∞–≤–∏—Ç—å POI –º–∞—Ä–∫–µ—Ä —Å –∞–≤—Ç–æ-ID", text("/bluemap markers addset <category> <x> <y> <z> <label>").color(HIGHLIGHT_COLOR)),
        format("% - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã", text("/bluemap markers save").color(HIGHLIGHT_COLOR)),
        format("% - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã", text("/bluemap markers reload").color(HIGHLIGHT_COLOR)),
        format("% - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã", text("/bluemap markers examples").color(HIGHLIGHT_COLOR))
    );
}
```

## üéÆ –ù–û–í–´–ï –ö–û–ú–ê–ù–î–´

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:
```bash
/bluemap markers create cities "–ì–æ—Ä–æ–¥–∞"
/bluemap markers create villages "–î–µ—Ä–µ–≤–Ω–∏"
/bluemap markers create landmarks "–î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ ID:
```bash
/bluemap markers addset cities 0 70 0 "–°–ø–∞–≤–Ω"
/bluemap markers addset cities 100 65 200 "–ù–æ–≤—ã–π –≥–æ—Ä–æ–¥"
/bluemap markers addset villages -50 70 50 "–î–µ—Ä–µ–≤–Ω—è —É –ª–µ—Å–∞"
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ —Å —Ä—É—á–Ω—ã–º–∏ ID:
```bash
/bluemap markers add cities custom_1 -200 65 -200 "–û—Å–æ–±—ã–π –≥–æ—Ä–æ–¥"
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
```bash
/bluemap markers save     # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã
/bluemap markers reload   # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ä–∫–µ—Ä—ã
/bluemap markers list     # –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –º–∞—Ä–∫–µ—Ä–æ–≤
```

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í

### Live –º–∞—Ä–∫–µ—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
```
c:\Personal\TestServer\plugins\BlueMap\web\maps\world\live\markers.json
```

### –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
```json
{
  "cities": {
    "label": "–ì–æ—Ä–æ–¥–∞",
    "toggleable": true,
    "defaultHidden": false,
    "sorting": 0,
    "markers": {
      "marker_123456": {
        "type": "poi",
        "label": "–°–ø–∞–≤–Ω",
        "position": {"x": 0.0, "y": 70.0, "z": 0.0},
        "anchor": {"x": 16, "y": 16},
        "icon": "assets/poi.svg",
        "sorting": 100,
        "listed": true,
        "minDistance": 10,
        "maxDistance": 100000
      }
    }
  }
}
```

## üîÑ –ê–õ–ì–û–†–ò–¢–ú –†–ê–ë–û–¢–´

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**: `/bluemap markers create cities "–ì–æ—Ä–æ–¥–∞"`
   - –°–æ–∑–¥–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é –≤ –ø–∞–º—è—Ç–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `live/markers.json`

2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–∞**: `/bluemap markers addset cities 100 70 200 "–ì–æ—Ä–æ–¥"`
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ID: `marker_123456`
   - –°–æ–∑–¥–∞–µ—Ç –º–∞—Ä–∫–µ—Ä —Å —Ä—É—Å—Å–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
   - –î–æ–±–∞–≤–ª—è–µ—Ç –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `live/markers.json`

3. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**:
   - –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–∏—Ç–∞–µ—Ç `live/markers.json` –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
   - –ú–∞—Ä–∫–µ—Ä—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –º–µ–Ω—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ–∏—Å–∫ –ø–æ —Ä—É—Å—Å–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è–º

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:
```bash
python test-fixed-plugin.py
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. –°–æ–±–µ—Ä–∏—Ç–µ –ø–ª–∞–≥–∏–Ω: `gradlew build`
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ JAR –≤ `plugins/`
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã –∏–∑ `test_commands.txt`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://localhost:8100`

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ **–ö–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞—é—Ç –º–∞—Ä–∫–µ—Ä—ã —Å —á–∏—Å–ª–æ–≤—ã–º–∏ ID** (`marker_123456`)
- ‚úÖ **–ú–∞—Ä–∫–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ `live/markers.json`
- ‚úÖ **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –º–∞—Ä–∫–µ—Ä—ã** –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö
- ‚úÖ **–†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è** –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ **–ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —Ä—É—Å—Å–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è–º**
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π** —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID** —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É `addset`

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- üéØ **–ß–∏—Å–ª–æ–≤—ã–µ ID –º–∞—Ä–∫–µ—Ä–æ–≤**: `marker_1`, `marker_2`, etc.
- üá∑üá∫ **–†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è**: –ø–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ UTF-8
- üîç **–ü–æ–∏—Å–∫**: –ø–æ ID –∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º
- üìÅ **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**: —Å–æ–∑–¥–∞–Ω–∏–µ, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- üíæ **–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∫–æ–º–∞–Ω–¥—ã
- üåê **Live –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

## üöÄ –î–ê–õ–¨–ù–ï–ô–®–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
1. **–ò–∫–æ–Ω–∫–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –∏–∫–æ–Ω–æ–∫
2. **–ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç** - –∑–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏–∑ CSV/JSON
3. **–ö–æ–º–∞–Ω–¥–∞ –ø–æ–∏—Å–∫–∞** - `/bluemap markers find <–Ω–∞–∑–≤–∞–Ω–∏–µ>`
4. **–¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è** - `/bluemap markers tp <marker_id>`
5. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –ø–ª–∞–≥–∏–Ω–∞–º–∏:
- **WorldGuard** - –º–∞—Ä–∫–µ—Ä—ã —Ä–µ–≥–∏–æ–Ω–æ–≤
- **Dynmap** - –∏–º–ø–æ—Ä—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∞—Ä–∫–µ—Ä–æ–≤
- **Essentials** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–∞—Ä–ø–∞–º–∏

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

### –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. **–§–∞–π–ª –º–∞—Ä–∫–µ—Ä–æ–≤**: `live/markers.json` –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
2. **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞**: –ø–ª–∞–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –∑–∞–ø–∏—Å–∏
3. **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
4. **–ö–æ–Ω—Å–æ–ª—å**: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞

### –õ–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
```
[BlueMap] Markers saved to live/markers.json for map: world
[BlueMap] Added marker marker_123456 to set cities
``` 